box: phusion/passenger-ruby22
dev:
  steps:
    - bundle-install
    - internal/watch:
        code: |
          bundle exec thin -R config.ru -p 8080 start
        reload: true
build:
    steps:
        - script:
            name: inspect env
            code: export -p
        - script:
            name: install docker command
            code: |
              curl -L -o /usr/bin/docker https://get.docker.io/builds/Linux/x86_64/docker-1.5.0
              chmod +x /usr/bin/docker
        - script:
            name: docker info
            code: |
              export DOCKER_HOST=tcp://172.17.42.1:2375
              docker info
              docker version
              docker ps -a
              docker inspect $(docker ps -a -q)
        - bundle-install
        - script:
            name: rspec
            code: bundle exec rspec
